# Gemini Agent Operating Guidelines (ATİS Project)

This document outlines the rules, technical standards, and best practices for contributing to the ATİS project using the Gemini AI agent. The agent's purpose is to accelerate the development process while maintaining the project's high standards for quality and security.

---

## 1. ❗ Core Operational Directive

**All user prompts, which are typically in Azerbaijani, must first be translated into technical English for internal analysis. All subsequent actions and logic should be based on this translated prompt. However, all final user-facing responses, explanations, and summaries must be provided in Azerbaijani.**

---

## 2. Core Principles

-   **Purpose:** The agent serves as an assistant for software development tasks, including code generation, debugging, refactoring, writing tests, and documentation.
-   **Instructions:** Prompts given to the agent must be clear, detailed, and specific. Describe the context of the problem, the affected files, and the expected outcome.

---

## 3. ⚠️ CRITICAL: Docker-Only Development Environment

**Local development on the host machine is strictly forbidden. All development processes must be conducted exclusively through the provided Docker environment.**

-   ❌ **PROHIBITED:** Do not run local server commands like `php artisan serve` or `npm run dev` directly on your machine.
-   ✅ **MANDATORY:** Only use the following scripts to start and stop the system:
    ```bash
    # To start the system
    ./start.sh

    # To stop the system
    ./stop.sh
    ```

### Working with Docker Containers

All `artisan`, `composer`, `npm`, and `psql` commands must be executed inside their respective containers using `docker exec`.

-   **Backend (Laravel) Commands:**
    ```bash
    # Example: Run migrations
    docker exec atis_backend php artisan migrate

    # Example: Run tests
    docker exec atis_backend php artisan test

    # Example: Install Composer packages
    docker exec atis_backend composer install
    ```

-   **Frontend (React) Commands:**
    ```bash
    # Example: Install npm packages
    docker exec atis_frontend npm install

    # Example: Build for production
    docker exec atis_frontend npm run build
    ```

-   **PostgreSQL Commands:**
    ```bash
    # Example: Check the user count
    docker exec atis_postgres psql -U atis_dev_user -d atis_dev -c "SELECT COUNT(*) FROM users;"
    ```

---

## 4. ✅ Mandatory Quality & Security Gates

Before every `commit`, the following quality assurance commands must be executed.

```bash
# Frontend code quality and static analysis
docker exec atis_frontend npm run lint
docker exec atis_frontend npm run typecheck

# Backend tests
docker exec atis_backend php artisan test
docker exec atis_backend composer test

# Security vulnerability scans
docker exec atis_frontend npm audit --audit-level=moderate
docker exec atis_backend composer audit
```

### AI-Generated Code Review Checklist

Before committing any code generated by the agent, verify the following:

-   **[ ] Comprehension:** Can you explain every line of the generated code?
-   **[ ] Consistency:** Does the code adhere to the project's existing style and architecture?
-   **[ ] Security:** Is the code free of hard-coded secrets? Are security vulnerabilities like SQL Injection and XSS addressed?
-   **[ ] Performance:** Are database queries optimized? Have you avoided N+1 problems?
-   **[ ] Testing:** Are new unit or feature tests written for the code, and do all tests pass?
-   **[ ] Documentation:** Is complex logic explained with clear comments?
-   **[ ] Dependencies:** Are any new, unnecessary libraries added?

---

## 5. Project Technical Architecture

-   **Backend:** Laravel 11 (PHP 8.3), PostgreSQL 16, Redis, `spatie/laravel-permission`.
-   **Frontend:** React 19 (TypeScript), Vite, Tailwind CSS, Shadcn/ui, Radix UI, `@tanstack/react-query`.
-   **Infrastructure:** Docker, Nginx.

---

## 6. Development Workflows

### Database Modifications

-   **Development Only:** To reset the database and run seeders, use:
    ```bash
    docker exec atis_backend php artisan migrate:fresh --seed
    ```
-   **Mandatory Rule:** Never modify an existing migration file. Create a new migration for every database schema change.
-   **Production Risk:** **NEVER** run destructive commands like `migrate:fresh` or `db:seed` in the production environment.

### Adding New Features

1.  **Analysis:** Before implementation, search the existing codebase for similar functionality to avoid duplication (`grep`, `find`).
2.  **Backend:** Create `Controller`, `Model`, `Migration`, and `Route` as needed. Ensure all new API endpoints are protected with proper authorization checks.
3.  **Frontend:** Create `Component`, `Service`, and `Type` definitions. Utilize the centralized API services.
4.  **Testing:** Write corresponding tests for both the backend (API) and frontend (UI).
5.  **Quality Check:** Run all mandatory quality gate commands (see Section 4).

---

## 7. Development Test Credentials

**⚠️ For use in the local Docker development environment ONLY.**

-   **SuperAdmin:** `superadmin@atis.az` / `admin123`
-   **RegionAdmin:** `admin@atis.az` / `admin123`
-   **TestUser:** `test@example.com` / `test123`
